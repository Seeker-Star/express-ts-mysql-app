# Express TypeScript MySQL App

âš ï¸ **ä»…ç”¨äºä¸ªäººç»ƒä¹ å­¦ä¹ ï¼Œæ— å®é™…åŠŸèƒ½**

ä¸€ä¸ªåŸºäº Express + TypeScript + MySQL çš„ Web åº”ç”¨ç¨‹åºç»ƒä¹ é¡¹ç›®ï¼Œç”¨äºå­¦ä¹ å’ŒæŒæ¡ç›¸å…³æŠ€æœ¯æ ˆã€‚

## å­¦ä¹ å†…å®¹

- ğŸš€ Express.js + TypeScript åŸºç¡€æ¶æ„
- ğŸ—„ï¸ MySQL æ•°æ®åº“è¿æ¥å’Œæ“ä½œ
- ğŸ“ Winston æ—¥å¿—ç³»ç»Ÿé›†æˆ
- ğŸ” ç¯å¢ƒå˜é‡ç®¡ç†å’Œå®‰å…¨é…ç½®
- ğŸš¢ è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ç¼–å†™
- ğŸ—ï¸ åˆ†å±‚æ¶æ„å’Œæ¨¡å—åŒ–è®¾è®¡
- ğŸ§ª å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ (Jest + TypeScript)
- ğŸ“Š ä»£ç è¦†ç›–ç‡æŠ¥å‘Š

## å…è´£å£°æ˜

æ­¤é¡¹ç›®ä»…ç”¨äºä¸ªäººæŠ€æœ¯å­¦ä¹ å’Œç»ƒä¹ ï¼Œä»£ç ä¸­å¯èƒ½åŒ…å«ç¤ºä¾‹æ•°æ®å’Œé…ç½®ï¼Œä¸å»ºè®®ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥çœŸå®çš„é…ç½®ä¿¡æ¯ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=your_database_host
DB_USER=your_database_user
DB_PASSWORD=your_database_password
DB_DATABASE=your_database_name

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development

# éƒ¨ç½²é…ç½®ï¼ˆå¯é€‰ï¼‰
DEPLOY_SERVER_IP=your_server_ip
DEPLOY_SERVER_USER=your_server_user
DEPLOY_SERVER_PASSWORD=your_server_password
DEPLOY_DIR=~/node-service
PROJECT_NAME=express-ts-mysql-app
```

### 3. æ•°æ®åº“è®¾ç½®

ç¡®ä¿ä½ çš„ MySQL æ•°æ®åº“ä¸­æœ‰ä¸€ä¸ª `users` è¡¨ï¼š

```sql
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    address VARCHAR(255)
);
```

### 4. è¿è¡Œåº”ç”¨

å¼€å‘æ¨¡å¼ï¼š
```bash
npm run dev
```

ç”Ÿäº§æ¨¡å¼ï¼š
```bash
npm run build
npm start
```

## API æ¥å£

- `GET /users` - è·å–æ‰€æœ‰ç”¨æˆ·
- `GET /add-user` - æ·»åŠ éšæœºç”¨æˆ·
- `GET /health` - å¥åº·æ£€æŸ¥æ¥å£

## éƒ¨ç½²

ä½¿ç”¨è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ï¼š

```bash
./deploy.sh
```

ç¡®ä¿åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®äº†æ­£ç¡®çš„éƒ¨ç½²ä¿¡æ¯ã€‚

## æ—¥å¿—ç³»ç»Ÿ

åº”ç”¨ä½¿ç”¨ Winston è¿›è¡Œæ—¥å¿—ç®¡ç†ï¼š

- å¼€å‘ç¯å¢ƒï¼šå½©è‰²æ§åˆ¶å°è¾“å‡º
- ç”Ÿäº§ç¯å¢ƒï¼šæ–‡ä»¶å­˜å‚¨åœ¨ `logs/` ç›®å½•
- æ”¯æŒæ—¥å¿—è½®è½¬å’Œç»“æ„åŒ–æ—¥å¿—

## é¡¹ç›®ç»“æ„

```
express-ts-mysql-app/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ config/                   # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ database.ts           # æ•°æ®åº“é…ç½®å’Œè¿æ¥
â”‚   â”‚   â””â”€â”€ env.ts                # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”œâ”€â”€ controllers/              # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â””â”€â”€ userController.ts     # ç”¨æˆ·æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ errorHandler.ts       # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ logger.ts             # æ—¥å¿—ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ routes/                   # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ index.ts              # è·¯ç”±æ±‡æ€»
â”‚   â”‚   â””â”€â”€ userRoutes.ts         # ç”¨æˆ·è·¯ç”±
â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â””â”€â”€ userService.ts        # ç”¨æˆ·æœåŠ¡
â”‚   â”œâ”€â”€ types/                    # TypeScript ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ user.ts               # ç”¨æˆ·ç›¸å…³ç±»å‹
â”‚   â”œâ”€â”€ utils/                    # å·¥å…·å‡½æ•°
â”‚   â”‚   â””â”€â”€ logger.ts             # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ app.ts                    # åº”ç”¨é…ç½®å’Œåˆå§‹åŒ–
â”‚   â””â”€â”€ index.ts                  # åº”ç”¨å…¥å£æ–‡ä»¶
â”œâ”€â”€ tests/                        # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ app.test.ts               # åº”ç”¨é…ç½®æµ‹è¯•
â”‚   â”œâ”€â”€ database.test.ts          # æ•°æ®åº“æµ‹è¯•
â”‚   â”œâ”€â”€ integration.test.ts       # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ logger.test.ts            # æ—¥å¿—æ¨¡å—æµ‹è¯•
â”‚   â”œâ”€â”€ routes.test.ts            # è·¯ç”±æµ‹è¯•
â”‚   â””â”€â”€ setup.ts                  # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ dist/                         # ç¼–è¯‘åçš„æ–‡ä»¶
â”œâ”€â”€ logs/                         # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ coverage/                     # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
â”œâ”€â”€ .env.test                     # æµ‹è¯•ç¯å¢ƒå˜é‡
â”œâ”€â”€ jest.config.js                # Jest é…ç½®
â”œâ”€â”€ tsconfig.json                 # TypeScript é…ç½®
â”œâ”€â”€ deploy.sh                     # éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ TEST_REPORT.md                # æµ‹è¯•æŠ¥å‘Š
â”œâ”€â”€ STRUCTURE.md                  # é¡¹ç›®ç»“æ„è¯¦ç»†è¯´æ˜
â””â”€â”€ README.md                     # é¡¹ç›®è¯´æ˜
```

## å®‰å…¨è¯´æ˜

- æ‰€æœ‰æ•æ„Ÿä¿¡æ¯å·²ç§»åŠ¨åˆ° `.env` æ–‡ä»¶
- `.env` æ–‡ä»¶å·²æ·»åŠ åˆ° `.gitignore`
- ä½¿ç”¨ `.env.example` ä½œä¸ºé…ç½®æ¨¡æ¿

## æ¶æ„ç‰¹ç‚¹

### åˆ†å±‚æ¶æ„
- **Controller Layer**: å¤„ç†HTTPè¯·æ±‚å’Œå“åº”
- **Service Layer**: ä¸šåŠ¡é€»è¾‘å¤„ç†
- **Config Layer**: é…ç½®ç®¡ç†
- **Middleware Layer**: ä¸­é—´ä»¶å¤„ç†
- **Types Layer**: TypeScriptç±»å‹å®šä¹‰

### æ ¸å¿ƒç‰¹æ€§
- ğŸ—ï¸ **æ¨¡å—åŒ–è®¾è®¡**: ä»£ç æŒ‰åŠŸèƒ½åˆ†å±‚ç»„ç»‡
- ğŸ”’ **ç±»å‹å®‰å…¨**: å®Œå–„çš„TypeScriptç±»å‹å®šä¹‰
- ğŸ›¡ï¸ **é”™è¯¯å¤„ç†**: å…¨å±€é”™è¯¯å¤„ç†ä¸­é—´ä»¶
- ğŸ“ **è¯·æ±‚æ—¥å¿—**: è¯¦ç»†çš„è¯·æ±‚å“åº”æ—¥å¿—
- ğŸ§ª **æµ‹è¯•å®Œæ•´**: 42ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ88.88%è¦†ç›–ç‡
- âš¡ **å¼‚æ­¥å¤„ç†**: Promise-basedæ•°æ®åº“æ“ä½œ

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘è§†æ¨¡å¼
npm run test:watch

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

### æµ‹è¯•è¦†ç›–
- **å•å…ƒæµ‹è¯•**: å„æ¨¡å—ç‹¬ç«‹æµ‹è¯•
- **é›†æˆæµ‹è¯•**: ç«¯åˆ°ç«¯å·¥ä½œæµæµ‹è¯•
- **æ€§èƒ½æµ‹è¯•**: å¹¶å‘è¯·æ±‚å¤„ç†æµ‹è¯•
- **é”™è¯¯å¤„ç†**: å¼‚å¸¸åœºæ™¯æµ‹è¯•

## å¼€å‘

```bash
# å¼€å‘æ¨¡å¼
npm run dev

# æ„å»º
npm run build

# å¯åŠ¨
npm start
```

## æ–‡æ¡£

- ğŸ“‹ [æµ‹è¯•æŠ¥å‘Š](TEST_REPORT.md) - è¯¦ç»†çš„æµ‹è¯•åˆ†æå’Œè¦†ç›–ç‡æŠ¥å‘Š
- ğŸ—ï¸ [ç»“æ„è¯´æ˜](STRUCTURE.md) - é¡¹ç›®æ¶æ„å’Œä¼˜åŒ–è¯¦æƒ…